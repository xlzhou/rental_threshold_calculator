<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help - Rental Threshold Calculator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .help-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .help-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        .help-section h2 {
            color: #2c3e50;
            margin-top: 0;
        }
        .help-section h3 {
            color: #34495e;
            margin-top: 20px;
        }
        .parameter-list {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .parameter-list dt {
            font-weight: bold;
            color: #2c3e50;
            margin-top: 10px;
        }
        .parameter-list dd {
            margin-left: 20px;
            margin-bottom: 8px;
        }
        .example-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .back-link {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #3498db;
            color: white;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
        }
        .back-link:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <a href="javascript:window.close()" class="back-link">â† Close Help</a>
    
    <div class="help-container">
        <header>
            <h1>Rental Threshold Calculator - Help Guide</h1>
            <p>Learn how to use the calculator to optimize your rental inventory decisions</p>
        </header>

        <div class="help-section">
            <h2>ğŸ¯ What is the Rental Threshold Calculator?</h2>
            <p>This tool helps you determine the optimal pricing threshold for accepting rental requests. It uses dynamic programming to find the best policy that maximizes your revenue while managing inventory risk.</p>
            <p>è¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©ä½ ç¡®å®šæ¥å—ç§Ÿèµè¯·æ±‚çš„æœ€ä½³ä»·æ ¼é˜ˆå€¼ã€‚å®ƒä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œåœ¨æœ€å¤§åŒ–æ”¶ç›Šçš„åŒæ—¶ï¼Œæ§åˆ¶åº“å­˜é£é™©ã€‚</p>

            <h3>Key Concepts:</h3>
            <ul>
                <li><strong>Static Threshold:</strong> A fixed price below which you reject all offers<br>
                    é™æ€é˜ˆå€¼ï¼ˆStatic Thresholdï¼‰ï¼šä¸€ä¸ªå›ºå®šçš„ä»·æ ¼ï¼Œä½äºè¯¥ä»·æ ¼çš„æ‰€æœ‰æŠ¥ä»·éƒ½è¢«æ‹’ç»ã€‚</li>
                <li><strong>Dynamic Threshold:</strong> A time and inventory-dependent threshold that adapts to current conditions<br>
                    åŠ¨æ€é˜ˆå€¼ï¼ˆDynamic Thresholdï¼‰ï¼šä¸€ä¸ªéšæ—¶é—´å’Œåº“å­˜å˜åŒ–è€Œè°ƒæ•´çš„é˜ˆå€¼ï¼Œèƒ½å¤Ÿæ ¹æ®å½“å‰çŠ¶å†µè‡ªé€‚åº”ã€‚</li>
                <li><strong>Policy:</strong> The decision rule that tells you whether to accept or reject an offer<br>
                    å†³ç­–ç­–ç•¥ï¼ˆPolicyï¼‰ï¼šä¸€æ¡å†³ç­–è§„åˆ™ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦æ¥å—æˆ–æ‹’ç»æŸä¸ªæŠ¥ä»·ã€‚</li>
            </ul>
        </div>

        <div class="help-section">
            <h2>ğŸ“Š Input Parameters</h2>
            <div class="parameter-list">
                <dl>
                    <dt>Starting Inventory (X)</dt>
                    <dd>The number of units (servers) you have available at the beginning</dd>
                    <dd>èµ·å§‹çš„åº“å­˜æ•°é‡ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯å¾…ç§Ÿèµçš„æœåŠ¡å™¨å°æ•°</dd>

                    <dt>Horizon Length (days)</dt>
                    <dd>Total days in the planning horizon (e.g., 30 days)</dd>
                    <dd>é”€å”®å‘¨æœŸå†…æ€»å¤©æ•°ï¼Œä¾‹å¦‚ï¼šæœˆåº¦è§„åˆ’æ—¶é€šå¸¸å– 30 å¤©ï¼›å¹´åº¦è§„åˆ’å¯å– 365 å¤©</dd>

                    <dt>Unit Cost (c)</dt>
                    <dd>The cost per unit in thousands. This is your break-even point</dd>
                    <dd>å•ä½æˆæœ¬</dd>
                    
                    <dt>Salvage Value (s)</dt>
                    <dd>The value you can recover from unsold inventory at the end (default: 0)</dd>
                    <dd>æ®‹å€¼ï¼Œåœ¨ç§Ÿèµä¸šåŠ¡ä¸­ï¼Œæ®‹å€¼ä¸€èˆ¬ä¸º0ï¼Œå°±æ˜¯æ²¡ç§Ÿå‡ºå»æ²¡æœ‰ä»»ä½•æ”¶ç›Š</dd>

                    <dt>Arrival Rate</dt>
                    <dd>Average number of customers arriving per period (e.g., 0.8 means 0.8 customers per day on average)</dd>
                    <dd>å¹³å‡å®¢æˆ·åˆ°è¾¾ç‡ï¼ˆæ¯ä¸ªå‘¨æœŸï¼‰ï¼Œæ¯”å¦‚å‘¨æœŸä¸ºæœˆï¼Œåˆ™0.8ä»£è¡¨æ¯å¤©å¹³å‡æ”¶åˆ°0.8ä¸ªæŠ¥ä»·ï¼Œæœ¬æœˆå†…æ€»å…±æœ‰30*0.8=24ä¸ªæŠ¥ä»·</dd>
                    <dt>Target Leftover (L*)</dt>
                    <dd>Desired number of units to keep in reserve (default: 3)</dd>
                    <dd>Target Leftover (L*) â€“ ç›®æ ‡å‰©ä½™åº“å­˜
                        å®šä¹‰ï¼šåœ¨æ•´ä¸ªé”€å”®/ç§Ÿèµå‘¨æœŸç»“æŸæ—¶ï¼Œä½ å…è®¸æœ€å¤šå‰©ä¸‹çš„åº“å­˜æ•°é‡ã€‚
                        åœ¨ä½ çš„è®¾å®šé‡Œï¼ŒL* = 3ã€‚
                        å«ä¹‰ï¼šè¿™æ˜¯ä¸€ä¸ªâ€œè½¯ç›®æ ‡â€ï¼Œå³ä¾¿æœ€åçœŸçš„å‰© 3 ä¸ªæ²¡ç§Ÿæ‰ï¼Œä¹Ÿç®—æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¸ç®—å¤±è´¥ã€‚
                        ä½œç”¨ï¼šè®¡ç®—æ¥å—é˜ˆå€¼æ—¶ï¼Œå…¬å¼ä¼šå°½é‡ä¿è¯åœ¨é¢„æœŸä¸ŠæŠŠåº“å­˜å–åˆ°åªå‰© â‰¤ L*ã€‚
                        æ¯”å¦‚ä½ æœ‰ 19 ä¸ªåº“å­˜ï¼Œç›®æ ‡ L* = 3ï¼Œå°±æ„å‘³ç€å¿…é¡»è‡³å°‘å–æ‰ 16 ä¸ªã€‚
                        äºæ˜¯ç³»ç»Ÿä¼šæ ¹æ®æŠ¥ä»·åˆ†å¸ƒå’Œå‰©ä½™å¤©æ•°ï¼Œé€‰æ‹©ä¸€ä¸ªé˜ˆå€¼ï¼ˆæœ€ä½æ¥å—ä»·ï¼‰ï¼Œä½¿å¾—é¢„æœŸé”€é‡ â‰¥16ã€‚</dd>

                    <dt>Failure Threshold</dt>
                    <dd>Maximum leftover inventory before it's considered a failure (default: 5)</dd>
                    
                    <dd>Failure Threshold â€“ å¤±è´¥é—¨æ§›
                        å®šä¹‰ï¼šå¦‚æœæœŸæœ«å‰©ä½™åº“å­˜è¶…è¿‡è¿™ä¸ªæ•°å€¼ï¼Œåˆ™è¢«è§†ä¸ºå½»åº•å¤±è´¥ã€‚
                        åœ¨ä½ çš„è®¾å®šé‡Œï¼ŒFailure Threshold = 5ã€‚
                        å«ä¹‰ï¼šè¿™æ˜¯ä¸€ä¸ªâ€œç¡¬çº¦æŸâ€ã€‚å¦‚æœæœ€åå‰©ä½™é‡ > 5ï¼Œå°±ç®—ä¸­é€”èµšäº†ä¸€ç‚¹é’±ï¼Œä¹Ÿè¢«è§†ä¸ºä»»åŠ¡å¤±è´¥ã€‚
                        ä½œç”¨ï¼š
                        åœ¨è®¡ç®—æ¥å—é˜ˆå€¼æ—¶ï¼Œå“ªæ€•ç‰ºç‰²åˆ©æ¶¦ï¼ˆæ¥å—ä½äºæˆæœ¬çš„ sub-c æŠ¥ä»·ï¼‰ï¼Œä¹Ÿè¦é¿å…è¶…è¿‡è¿™ä¸ªé—¨æ§›ã€‚
                        ç¨‹åºé‡Œä¼šåš Safety Checkï¼šå¦‚æœç”¨å½“å‰é˜ˆå€¼é¢„è®¡å‰©ä½™ > 5ï¼Œå°±è‡ªåŠ¨é™ä½é˜ˆå€¼ï¼ˆæ¥å—æ›´å¤šä½ä»·ï¼‰ï¼Œä»¥ç¡®ä¿å®‰å…¨ã€‚</dd>
                </dl>
            </div>
        </div>

        <div class="help-section">
            <h2>ğŸ’° Price Input Methods</h2>
            
            <h3>1. Manual Entry</h3>
            <p>Enter historical prices separated by commas. Example: <code>65,64,60,59,55</code></p>
            <p>è¾“å…¥å†å²ä»·æ ¼ï¼Œç”¨é€—å·åˆ†éš”</p>
            
            <h3>2. CSV File Upload</h3>
            <p>Upload a CSV file with prices. The file should have one column with numerical values:</p>
            <div class="example-box">
                <strong>Example CSV format:</strong><br>
                65<br>
                64<br>
                60<br>
                59<br>
                55
            </div>
        </div>

        <div class="help-section">
            <h2>ğŸ” Current State Analysis</h2>
            <p>Use this section to check what the optimal decision is for your current situation:</p>
            
            <div class="parameter-list">
                <dl>
                    <dt>Offer Price</dt>
                    <dd>The price a customer is currently offering</dd>
                    <dd>å®¢æˆ·å‡ºä»·</dd>
                    
                    <dt>Current Period</dt>
                    <dd>Which time period you're currently in (0 to T-1)</dd>
                    <dd>å½“å‰æ˜¯å‘¨æœŸçš„ç¬¬å‡ å¤©</dd>
                    
                    
                    <dt>Current Inventory</dt>
                    <dd>How many units you currently have available</dd>
                    <dd>å½“å‰å¯ç”¨åº“å­˜</dd>
                </dl>
            </div>
        </div>

        <div class="help-section">
            <h2>ğŸ“ˆ Understanding Results</h2>
            
            <h3>Threshold Display</h3>
            <ul>
                <li><strong>$X.XX K:</strong> Accept offers above this price</li>
                <li><strong>$0.00 K:</strong> Accept any offer (usually when inventory is high and time is running out)</li>
                <li><strong>No offers accepted:</strong> Reject all offers (usually at end of period or no inventory)</li>
            </ul>
            
            <h3>When Threshold is $0.00</h3>
            <p>This happens when:</p>
            <ul>
                <li>You have too much inventory relative to remaining time</li>
                <li>The algorithm prioritizes selling over holding inventory</li>
                <li>Salvage value is low or zero</li>
            </ul>
        </div>

        <div class="help-section">
            <h2>ğŸšš Arrival Model (DP)</h2>
            <p><strong>English:</strong> The dynamic programming model treats arrivals as a per-period Bernoulli event with probability p_arrival = 1 âˆ’ exp(âˆ’Î»). The rate Î» comes from the "Arrival Rate" field; if total arrivals N over T periods are known, Î» = N/T. Each period combines a no-arrival branch and an arrival branch in the Bellman update:</p>
            <div class="example-box">
                V_t(x) = (1 âˆ’ p_arrival) Â· V_{t+1}(x) + p_arrival Â· E_p[ max{ p âˆ’ c + V_{t+1}(xâˆ’1), V_{t+1}(x) } ]
            </div>
            <ul>
                <li>One price draw is considered only when an arrival occurs.</li>
                <li>If no arrival, inventory carries forward unchanged.</li>
                <li>Static analysis uses expected total arrivals N directly; DP uses per-period arrival probability. For large arrival rates, p_arrival â‰ˆ 1 (â‰ˆ one offer per period).</li>
            </ul>
            <p><strong>ä¸­æ–‡ï¼š</strong> åŠ¨æ€è§„åˆ’å°†â€œå®¢æˆ·åˆ°è¾¾â€å»ºæ¨¡ä¸ºæ¯ä¸ªå‘¨æœŸä¸€æ¬¡çš„ä¼¯åŠªåˆ©äº‹ä»¶ï¼Œæ¦‚ç‡ä¸º p_arrival = 1 âˆ’ exp(âˆ’Î»)ã€‚Î» æ¥è‡ªâ€œåˆ°è¾¾ç‡â€è¾“å…¥ï¼›è‹¥ç»™å‡ºæ€»åˆ°è¾¾ N ä¸å‘¨æœŸæ•° Tï¼Œåˆ™ Î» = N/Tã€‚è´å°”æ›¼æ–¹ç¨‹å°†â€œæ— åˆ°è¾¾â€å’Œâ€œæœ‰åˆ°è¾¾â€ä¸¤ç§æƒ…å†µåŠ æƒï¼š</p>
            <div class="example-box">
                V_t(x) = (1 âˆ’ p_arrival) Â· V_{t+1}(x) + p_arrival Â· E_p[ max{ p âˆ’ c + V_{t+1}(xâˆ’1), V_{t+1}(x) } ]
            </div>
            <ul>
                <li>åªæœ‰åœ¨â€œæœ‰åˆ°è¾¾â€æ—¶æ‰è¿›è¡Œä¸€æ¬¡ä»·æ ¼æŠ½æ ·ä¸æ¥å—/æ‹’ç»å†³ç­–ã€‚</li>
                <li>è‹¥â€œæ— åˆ°è¾¾â€ï¼Œåº“å­˜ç›´æ¥ç»“è½¬åˆ°ä¸‹ä¸€å‘¨æœŸã€‚</li>
                <li>é™æ€åˆ†æç›´æ¥ä½¿ç”¨æ€»åˆ°è¾¾ Nï¼›DP ä½¿ç”¨æ¯å‘¨æœŸåˆ°è¾¾æ¦‚ç‡ã€‚åˆ°è¾¾ç‡è¾ƒå¤§æ—¶ï¼Œp_arrival â‰ˆ 1ï¼ˆè¿‘ä¼¼æ¯å‘¨æœŸéƒ½æœ‰ä¸€æ¬¡æŠ¥ä»·ï¼‰ã€‚</li>
            </ul>
        </div>

        <div class="help-section">
            <h2>ğŸ§® Variable Duration (SOBP)</h2>
            <p><strong>English:</strong> For a rental with duration D periods, we use a Sum of Bid Prices (SOBP) heuristic to account for multi-period occupancy. The per-period threshold is:</p>
            <div class="example-box">
                per-threshold = max(cost_floor, c + (Î£ b_{t+i}(x))/D)
            </div>
            <p>The total-price threshold is:</p>
            <div class="example-box">
                total-threshold = max(DÂ·cost_floor, DÂ·c + Î£ b_{t+i}(x))
            </div>
            <ul>
                <li>If D extends beyond the horizon, a terminal shadow bid is applied for the extra periods.</li>
                <li>Offer type can be per-period or total. The UI shows both thresholds.</li>
            </ul>
            <p><strong>ä¸­æ–‡ï¼š</strong> å¯¹äºç§ŸæœŸ D ä¸ªå‘¨æœŸçš„æŠ¥ä»·ï¼Œä½¿ç”¨â€œä½ç§»æˆæœ¬æ±‚å’Œï¼ˆSOBPï¼‰â€è¿‘ä¼¼è®¡ç®—é˜ˆå€¼ï¼Œæ˜¾å¼è®¡å…¥å¤šæœŸå ç”¨çš„æœºä¼šæˆæœ¬ï¼š</p>
            <div class="example-box">
                æ¯æœŸé˜ˆå€¼ = max(cost_floor, c + (Î£ b_{t+i}(x))/D)<br>
                æ•´å•é˜ˆå€¼ = max(DÂ·cost_floor, DÂ·c + Î£ b_{t+i}(x))
            </div>
            <ul>
                <li>è‹¥ D è¶…å‡ºå½“å‰è§†çª—ï¼Œç”¨â€œç»ˆç«¯å½±å­ä»·â€è¿‘ä¼¼è¶…å‡ºéƒ¨åˆ†çš„è¾¹é™…ä»·å€¼ã€‚</li>
                <li>æ”¯æŒâ€œæŒ‰æœŸä»·æ ¼/æ•´å•æ€»ä»·â€ä¸¤ç§å£å¾„ï¼Œå¹¶åœ¨ç•Œé¢ä¸­å±•ç¤ºä¸¤ç§é˜ˆå€¼ã€‚</li>
            </ul>
        </div>

        <div class="help-section">
            <h2>â±ï¸ Time Granularity Tips</h2>
            <p><strong>English:</strong> If expected total offers N in a month greatly exceeds T, either refine the time step (increase T so per-period arrival probability p â‰ˆ 1) or consider a future upgrade to allow multiple arrivals per period.</p>
            <p><strong>ä¸­æ–‡ï¼š</strong> å¦‚æœæœˆå†…æ€»æŠ¥ä»· N è¿œå¤§äº Tï¼Œå»ºè®®ç»†åŒ–æ—¶é—´ç²’åº¦ï¼ˆå¢å¤§ Tï¼Œä½¿æ¯æœŸ pâ‰ˆ1ï¼‰ï¼Œæˆ–åç»­å¯ç”¨â€œæœŸå†…å¤šåˆ°è¾¾â€çš„æ‰©å±•æ¨¡å‹ã€‚</p>
        </div>

        <div class="help-section">
            <h2>ğŸ’¡ Example Scenario</h2>
            <div class="example-box">
                <strong>Server Rental Business:</strong><br><br>
                â€¢ Starting Inventory: 10 servers<br>
                â€¢ Horizon Length: 30 days<br>
                â€¢ Unit Cost: $60K per server<br>
                â€¢ Arrival Rate: 0.8 customers/day<br>
                â€¢ Historical Prices: $65K, $64K, $60K, $59K, $55K<br><br>
                
                <strong>Interpretation:</strong><br>
                With 0.8 customers per day and 10 servers over 30 days, you expect ~24 customers. The calculator will find the optimal threshold to maximize profit while managing the risk of unsold inventory.
            </div>
        </div>

        <div class="help-section">
            <h2>âš ï¸ Common Issues</h2>
            
            <h3>Threshold Shows $0.00</h3>
            <p><strong>Cause:</strong> Too much inventory, too little time remaining<br>
            <strong>Solution:</strong> Increase arrival rate, reduce starting inventory, or extend time horizon</p>
            
            <h3>No Offers Accepted</h3>
            <p><strong>Cause:</strong> End of time horizon or no inventory remaining<br>
            <strong>Solution:</strong> Check current period and inventory values</p>
            
            <h3>Very High Thresholds</h3>
            <p><strong>Cause:</strong> Low arrival rate or high costs<br>
            <strong>Solution:</strong> Review arrival rate and cost parameters</p>
        </div>

        <div class="help-section">
            <h2>ğŸš€ Tips for Best Results</h2>
            <ul>
                <li>Use realistic historical price data for better accuracy</li>
                <li>Regularly update your current period and inventory</li>
                <li>Consider seasonal variations in arrival rates</li>
                <li>Monitor the difference between static and dynamic thresholds</li>
                <li>Adjust target leftover based on demand uncertainty</li>
            </ul>
        </div>
    </div>
</body>
</html>
